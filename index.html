<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title></title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

<script>
/* ===== 配置 ===== */
const LINK_JSON_URL = "https://9080.cc/lines.json";
const TIMEOUT = 2500;

/* ===== 带超时测速 ===== */
function test(url) {
  return new Promise(resolve => {
    const start = performance.now();
    const controller = new AbortController();
    const timer = setTimeout(() => controller.abort(), TIMEOUT);

    fetch(url, {
      method: "HEAD",
      mode: "no-cors",
      signal: controller.signal
    }).then(() => {
      clearTimeout(timer);
      resolve({
        url,
        time: performance.now() - start
      });
    }).catch(() => resolve(null));
  });
}

/* ===== 主逻辑 ===== */
(async () => {
  try {
    const res = await fetch(LINK_JSON_URL + "?t=" + Date.now());
    const links = await res.json();

    if (!Array.isArray(links) || !links.length) return;

    const tasks = links.map(url => test(url));
    const results = (await Promise.all(tasks)).filter(Boolean);

    if (!results.length) return;

    results.sort((a, b) => a.time - b.time);
    location.replace(results[0].url);

  } catch (e) {
    // 静默失败，不展示任何内容
  }
})();
</script>

</body>
</html>
